# Reproducible Research: Peer Assessment 1

```{r set-options, echo=TRUE, cache=FALSE}
```

## The Dataset used for the assignment

The data for this assignment was obtained from a personal activity monitoring  
device. Over the course of two months, October and November 2012, an anonmymous  
individual used the device to collect personal movement data that included the  
number of steps taken in 5 minute intervals each day. 

The steps data for this assignment can be downloaded from Dr. Roger Peng's   
Reproducible Research course website.

+ **Dataset:** [Activity monitoring data][1] [52K]
[1]: https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip  
"Activity monitoring data"

The dataset includes three variables:

1. **steps:**  The number of steps that were taken by the individual in each  
5-minute interval (missing values are represented by NA)

2. **data:**  The date on which the data was acquired in YYYY-MM-DD format
    
3. **interval:**  An identifier for the 5-minute interval in which the data was  
acquired

The dataset is stored in a comma-separated-value (CSV) file. There are a total  
of 17,568 observations.

## Goals of the Assignment

In this assignment, the steps data was used to answer the following three  
questions:

1. What was the mean total number of steps taken per day? (Missing values not  
imputed)

2. What was the average daily activity pattern? (Missing values not imputed)

3. Are there differences in activity patterns between weekdays and weekends?  
(Missing values imputed)

## Loading and preprocessing the data

### Download data and read from csv file into data frame

While, the github repository does contain the activity data in a zip file, I  
have opted to download the data from  the Course website cited above.

If directory to contain the data does not exist, make the directory

```{r}
if(!file.exists("Steps_Data")) {
    dir.create("Steps_Data")
}
```

Download the zip file

```{r}
zipURL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(zipURL,"./Steps_Data/temp",method = "curl")
```

Unzip zip file

```{r}
unzip("./Steps_Data/temp", exdir = "./Steps_Data/")
```

Delete the zip file

```{r}
unlink("./Steps_Data/temp")
```

Read data from csv file into data frame and view head of data frame

```{r}
stepData <- read.table("./Steps_Data/activity.csv", header = TRUE, sep = ",",
                       na.strings = "NA", 
                       colClasses = c("integer","character","integer"))
head(stepData)
```

### Preprocess the data

Convert dates which currently have class "character" to Date Objects

```{r}
stepData$date <- as.Date(stepData$date)
```

## What is mean total number of steps taken per day?

Load ggplot2 package for graphics generation
Load plyr package for ddply function

```{r}
library(ggplot2)
library(plyr)
```

Generate histogram of total number of steps taken per day

```{r totalStepsPerDay, fig.width = 10}
totalSteps <- ddply(stepData, c("date"),summarize,  
                    Frequency = sum(steps, na.rm = TRUE))
grob <- ggplot(totalSteps, aes(x = date, y = Frequency)) + geom_bar(stat = "identity")
print(grob)
```

Calculate mean total number of steps taken per day

```{r meanSteps}
mean(totalSteps$Frequency)
```

Calculate median total number of steps taken per day   

```{r medianSteps}
median(totalSteps$Frequency)
```

## What is the average daily activity pattern?
```{r timeSeries, fig.width = 10}
meanSPI <- ddply(stepData, c("interval"),summarise,  
                 mean = mean(steps, na.rm = TRUE))
timeGrob <- ggplot(meanSPI, aes(x = interval, y = mean)) + geom_line() + geom_point()
print(timeGrob)
```

Determine which 5-minute interval across all the days in the dataset, contains
the maximum number of steps taken.

```{r intervalMaxSteps}
meanSPI$interval[which.max(meanSPI$mean)]
```
## Imputing missing values

Calculate and report the total number of missing values in the data set.

```{r totalNAs}
sum(is.na(stepData$steps))
```

To devise a reasonable strategy for imputing the missing data values, I  
needed to get an idea of how the NAs were distributed throughout the data set.
For each date, I determined the day of the week corresponding to each date and    
the percentage of NA values.

```{r NAsPerDay}
dailyNAs <- ddply(stepData, c("date"),summarize,
                  percent_NA = 100 * sum(is.na(steps))/length(steps))
day_of_week <- weekdays(dailyNAs$date)
dailyNAs <- cbind(day_of_week, dailyNAs)
print(dailyNAs)
```

A brief examination of the the dailyNAs data frame revealed that each date   
either has all missing values (100%) or no missing values (0%). Out of the 61   
dates, there are 8 dates for which all of the values are missing.   
Two of these dates fall on a Monday, two on a Friday, and one each on Wednesday,   
Thursday, Saturday, and, Sunday. Based on this data, the following imputation  
strategy was devised:

For each five-minute interval, the missing value will be replaced with the mean   
of the five-minute interval for that particular day (e.g. if the missing value   
occurs at interval 4 on a Sunday, it will be replaced with the missing   
value with the mean number of steps for interval 4's that occur on Sundays).

The first step in the imputation process is generation of values that can be   
used for imputation. For each day of the week, the steps were counted for 288   
five-minute intervals. It is therefore necessary to generate means for the 288   
intervals that occured on Sundays, the 288 intervals that occured on Mondays,   
etc. Therefore 288 * 7 = 2016 means will be generated. Note, although there are   
no missing Tuesday values, mean values for Tuesday intervals will still be   
calculated. 

```{r generateImputationFrame}
day <- factor(
    weekdays(stepData$date),
    c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))
stepData <- cbind(day,stepData)
imputationFrame <- ddply(stepData, c("day","interval"), summarize,
                          mean = mean(steps, na.rm = TRUE))
```

Data collection began on 2012-10-01, a Monday, and ended on 2012-11-30, a   
Friday. Data was collected for 61 days with the steps recorded for 288  
five-minute intervals each day for a total of 17568 observations. The imputation   
table contains the means of the 288 intervals for each of the 7 days   
(Monday- Sunday) resulting in 2016 rows. To vectorize the missing value  
replacement operation, will generate a vector of length 17568 from the   
imputation Table's mean number of steps column

```{r generateImputationVector}
impVec <- c(rep(imputationFrame$mean, times = 8),imputationFrame$mean[1:1440])
```

Replace any missing value in the step data with its imputed value.

```{r replaceNAsInStepData}
stepData$steps[is.na(stepData$steps)] <- impVec[is.na(stepData$steps)]
```

Generate histogram of total number of steps taken per day

```{r totalStepsPerDayImputed, fig.width= 10}
totalSteps <- ddply(stepData, c("date"),summarize,  
                    Frequency = sum(steps, na.rm = TRUE))
grob <- ggplot(totalSteps, aes(x = date, y = Frequency))
grob + geom_bar(stat = "identity")
```

Calculate mean total number of steps taken per day

```{r meanStepsImputed}
mean(totalSteps$Frequency)
```

Calculate median total number of steps taken per day   

```{r medianStepsImputed}
median(totalSteps$Frequency)
```

## Are there differences in activity patterns between weekdays and weekends?

Create a new factor variable with two levels - "weekday" and "weekend"

```{r weekend_vs_Weekday}
stepData$day <- as.character(stepData$day)
stepData$day <- ifelse((stepData$day == "Saturday") | (stepData$day == "Sunday")
                       ,"weekend","weekday")
stepData$day <- factor(stepData$day)
```

Make a plot contaianing a time series plot of the five-minute interval and the
average number of steps taken.

```{r timeSeries_weekend_vs_weekday, fig.width = 10}
library(lattice)
meanSPI_weekend_vs_weekday <- ddply(stepData, c("day","interval"),summarise,  
                 mean = mean(steps))
xyplot(mean ~ interval | day, data = meanSPI_weekend_vs_weekday, type = "b",
       ylab = "Number of steps", layout = c(1,2))
```

## Software Environment 

```{r thisSession}
sessionInfo()
```